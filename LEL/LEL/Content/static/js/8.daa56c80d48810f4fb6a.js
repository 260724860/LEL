webpackJsonp([8],{KTvf:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),i=a("exGp"),n=a.n(i),o=a("Dd8w"),d=a.n(o),l=a("NYxO"),c={name:"Order",data:function(){return{orderType:"order",activeTab:"0",columns:[{title:"图片",key:"GoodsImg",width:80,render:function(e,t){return e("div",[e("img",{attrs:{src:t.row.GoodsImg,width:40,height:40}})])},align:"center"},{type:"html",title:"条码",width:250,key:"SerialNumber",align:"center"},{title:"商品",key:"GoodsName",align:"center"},{title:"属性",width:300,key:"specs",align:"center"},{title:"数量",width:150,key:"GoodsCount",align:"center"},{title:"金额",width:150,key:"Price",align:"center"},{title:"小计",width:150,key:"totalPrice",align:"center"}],remarks:"",ziti_addressId:"",wuliu_addressId:"",formData:{ownerName:"",phone:"",CarNumber:"",date:"",time:""},ruleInline:{ownerName:[{required:!0,message:"请输入取货人姓名",trigger:"blur"}],phone:[{required:!0,message:"手机号不能为空",trigger:"blur"},{type:"string",pattern:/^1[3|4|5|7|8|9][0-9]{9}$/,message:"手机号格式出错",trigger:"blur"}],CarNumber:[{required:!0,message:"请输入取货车牌号",trigger:"blur"}],date:[{required:!0,type:"date",message:"请选择取货日期",trigger:"change"}],time:[{required:!0,type:"string",message:"请选择取货时间",trigger:"change"}]},dateOptions:{disabledDate:function(e){return(new Date).getHours()>9?e&&e.valueOf()<Date.now():e&&e.valueOf()<Date.now()-864e5}},disabledHours:[0,1,2,3,4,5,6,7,8,19,20,21,22,23],disabledMinutes:[],disabledAllHours:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],disabledAllMinutes:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]}},computed:d()({},Object(l.d)(["shoppingCart","address","sysAddress","userInfo"]),{totalPrice:function(){var e=0;return this.shoppingCart.forEach(function(t){e+=t.Price*t.GoodsCount}),e},totalCount:{get:function(){var e=0;return this.shoppingCart.forEach(function(t){e+=t.GoodsCount}),e}}}),created:function(){var e=this;return n()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadShoppingCart(!0);case 2:return t.next=4,e.loadAddress();case 4:return t.next=6,e.loadSysAddress();case 6:e.initFormData(),e.ziti_addressId=e.sysAddress[0].AddressID,e.wuliu_addressId=e.address[0].AddressID;case 9:case"end":return t.stop()}},t,e)}))()},methods:d()({},Object(l.b)(["loadShoppingCart","loadAddress","loadSysAddress"]),{changeType:function(e){this.activeTab="0"},changeAddress:function(e){},initFormData:function(){this.formData.ownerName=this.userInfo.accattach.TrueName,this.formData.phone=this.userInfo.accattach.Mobile,this.formData.CarNumber=this.userInfo.accattach.CarNumber},submit:function(){var e=this;return n()(s.a.mark(function t(){var a,r,i,o,d,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=0===parseInt(e.activeTab)?e.ziti_addressId:e.wuliu_addressId,r="order"===e.orderType?1:2,i=0===parseInt(e.activeTab)?2:1,o=e.userInfo.accattach.UserID,"order"!==e.orderType||"0"!==e.activeTab){t.next=8;break}e.$refs.formInfo.validate(function(){var t=n()(s.a.mark(function t(n){var d,l,c,u,m,p,f;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=15;break}return d=e.formData.CarNumber,l=e.formData.ownerName,c=e.formData.phone,u=new RegExp("/","g"),m=(m=e.formData.date.toLocaleDateString()).replace(u,"-"),m+="T"+e.formData.time+":00.000Z",t.next=10,e.$request.saveOrder(o,a,e.remarks,r,i,d,m,l,c);case 10:p=t.sent,f=p?0:1,e.$router.push({path:"/pay",query:{result:f}}),t.next=16;break;case 15:e.$Message.error("请填写正确的信息");case 16:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()),t.next=13;break;case 8:return t.next=10,e.$request.saveOrder(o,a,e.remarks,r,i);case 10:d=t.sent,l=d?0:1,e.$router.push({path:"/pay",query:{result:l}});case 13:case"end":return t.stop()}},t,e)}))()},limitTime:function(e){if(e){var t=this.formData.date.toLocaleDateString(),a=(new Date).toLocaleDateString(),r=new Date;r.setDate(r.getDate()+1);var s=r.toLocaleDateString();if(t===a)this.disabledHours=[0,1,2,3,4,5,6,7,8,9,10,11,12,19,20,21,22,23],this.disabledMinutes=[];else if(t===s){(new Date).getHours()<17?(this.disabledHours=[0,1,2,3,4,5,6,7,8,19,20,21,22,23],this.disabledMinutes=[]):(this.disabledHours=[0,1,2,3,4,5,6,7,8,9,10,11,12,19,20,21,22,23],this.disabledMinutes=[])}else this.disabledHours=[0,1,2,3,4,5,6,7,8,19,20,21,22,23],this.disabledMinutes=[]}}})},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"goods-list-container"},[a("Alert",{staticClass:"tips-box",attrs:{"show-icon":""}},[e._v("\n\t\t\t小提示\n\t\t\t"),a("Icon",{attrs:{slot:"icon",type:"ios-lightbulb-outline"},slot:"icon"}),e._v(" "),a("template",{slot:"desc"},[e._v("请仔细检查商品数量和价格，确认无误后点击确认下单即可。")])],2),e._v(" "),a("Table",{attrs:{border:"",columns:e.columns,data:e.shoppingCart,size:"large","no-data-text":"您的订单没有商品，请先添加商品到购物车再点击购买"}}),e._v(" "),a("div",{staticClass:"go-to"},[a("span",{staticStyle:{"font-size":"16px","margin-right":"30px"}},[e._v("商品总量："+e._s(e.totalCount))]),e._v(" "),a("span",{staticStyle:{"font-size":"16px"}},[e._v("商品总价：￥"+e._s(e.totalPrice))])]),e._v(" "),a("RadioGroup",{staticStyle:{padding:"25px 0 0 0"},attrs:{type:"button"},on:{"on-change":e.changeType},model:{value:e.orderType,callback:function(t){e.orderType=t},expression:"orderType"}},[a("Radio",{attrs:{label:"order"}},[e._v("订货单")]),e._v(" "),a("Radio",{attrs:{label:"refund"}},[e._v("退货单")])],1),e._v(" "),a("Tabs",{staticStyle:{padding:"15px 0"},attrs:{value:"0"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("TabPane",{attrs:{label:"order"===e.orderType?"自提点":"退货点",name:"0"}},[a("div",{staticStyle:{"margin-left":"5px"}},[a("RadioGroup",{attrs:{vertical:"",size:"large"},on:{"on-change":e.changeAddress},model:{value:e.ziti_addressId,callback:function(t){e.ziti_addressId=t},expression:"ziti_addressId"}},e._l(e.sysAddress,function(t,r){return a("Radio",{key:r,attrs:{label:t.AddressID}},[a("span",[e._v(e._s(t.ReceiveName)+" "+e._s(t.ReceivePhone)+" "+e._s(t.ReceiveArea)+" "+e._s(t.ReceiveAddress))])])}),1)],1)]),e._v(" "),"order"===e.orderType?a("TabPane",{attrs:{label:"物流",name:"1"}},[a("div",{staticStyle:{"margin-left":"5px"}},[0===e.address.length?a("router-link",{attrs:{to:"/home/addAddress"}},[a("span",{staticClass:"address-content-title"},[e._v("暂无收货信息，点我去添加")])]):e._e(),e._v(" "),a("RadioGroup",{attrs:{vertical:"",size:"large"},on:{"on-change":e.changeAddress},model:{value:e.wuliu_addressId,callback:function(t){e.wuliu_addressId=t},expression:"wuliu_addressId"}},e._l(e.address,function(t,r){return a("Radio",{key:r,attrs:{label:t.AddressID}},[a("span",[e._v(e._s(t.ReceiveName)+" "+e._s(t.ReceivePhone)+" "+e._s(t.ReceiveArea)+" "+e._s(t.ReceiveAddress))])])}),1)],1)]):e._e()],1),e._v(" "),"order"===e.orderType&&"0"===e.activeTab?a("div",{staticClass:"remarks-container"},[a("Form",{ref:"formInfo",staticStyle:{width:"30%"},attrs:{model:e.formData,"label-position":"left","label-width":100,rules:e.ruleInline}},[a("FormItem",{attrs:{label:"取货人",prop:"ownerName"}},[a("i-input",{attrs:{size:"large"},model:{value:e.formData.ownerName,callback:function(t){e.$set(e.formData,"ownerName",t)},expression:"formData.ownerName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"联系电话",prop:"phone"}},[a("i-input",{attrs:{size:"large"},model:{value:e.formData.phone,callback:function(t){e.$set(e.formData,"phone",t)},expression:"formData.phone"}})],1),e._v(" "),a("FormItem",{attrs:{label:"取货车牌",prop:"CarNumber"}},[a("i-input",{attrs:{size:"large"},model:{value:e.formData.CarNumber,callback:function(t){e.$set(e.formData,"CarNumber",t)},expression:"formData.CarNumber"}})],1),e._v(" "),a("FormItem",{attrs:{label:"取货日期",prop:"date"}},[a("DatePicker",{attrs:{type:"date",placeholder:"请选择取货日期",options:e.dateOptions,editable:!1},model:{value:e.formData.date,callback:function(t){e.$set(e.formData,"date",t)},expression:"formData.date"}})],1),e._v(" "),e.formData.date?a("FormItem",{attrs:{label:"取货时间",prop:"time"}},[a("TimePicker",{attrs:{type:"time",placeholder:"请选择取货时间","hide-disabled-options":"","disabled-hours":e.disabledHours,"disabled-minutes":e.disabledMinutes,format:"HH:mm",editable:!1},on:{"on-open-change":e.limitTime},model:{value:e.formData.time,callback:function(t){e.$set(e.formData,"time",t)},expression:"formData.time"}})],1):e._e()],1)],1):e._e(),e._v(" "),a("div",{staticClass:"remarks-container"},[a("h3",[e._v("备注")]),e._v(" "),a("Input",{staticClass:"remarks-input",attrs:{type:"textarea",autosize:!0,placeholder:"在这里填写备注信息"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1),e._v(" "),a("div",{staticClass:"pay-container"},[a("div",{staticClass:"pay-box"},[a("p",[a("span",[e._v("提交订单应付总额：")]),e._v(" "),a("span",{staticClass:"money"},[a("Icon",{attrs:{type:"logo-yen"}}),e._v(e._s(e.totalPrice.toFixed(2)))],1)]),e._v(" "),a("div",{staticClass:"pay-btn"},[a("Button",{attrs:{type:"error",size:"large"},on:{click:e.submit}},[e._v("确认下单")])],1)])])],1)])},staticRenderFns:[]};var m=a("VU/8")(c,u,!1,function(e){a("dxHV")},"data-v-e0818150",null);t.default=m.exports},dxHV:function(e,t){}});
//# sourceMappingURL=8.daa56c80d48810f4fb6a.js.map