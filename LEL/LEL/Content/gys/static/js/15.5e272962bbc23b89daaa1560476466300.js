webpackJsonp([15],{L7zk:function(e,a,r){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=r("Xxa5"),t=r.n(s),o=r("exGp"),i=r.n(o),n=r("Dd8w"),l=r.n(n),u=r("NYxO"),d=r("E4LH"),m={name:"basic",data:function(){var e=this;return{formData:{shopName:"",ownerName:"",phone:"",address:"",email:"",IDCardNo:"",BusinessNo:""},UsersImage:null,allowType:["gif","jpg","bmp","jpeg","png"],ruleInline:{shopName:[{required:!0,message:"请输入供货店名称",trigger:"blur",validator:d.b}],ownerName:[{required:!0,message:"请输入负责人姓名",trigger:"blur",validator:d.b}],address:[{required:!0,message:"请输入店铺地址",trigger:"blur",validator:d.b}],email:[{validator:d.a,trigger:"blur"}],IDCardNo:[{required:!0,validator:function(e,a,r){/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(a)?r():r("身份证号有误")},trigger:"blur"}],BusinessNo:[{required:!0,message:"请输入营业执照",trigger:"blur"}]},formValidate:{oldPassword:"",password:"",rePassword:""},ruleValidate:{oldPassword:[{required:!0,message:"旧密码不能为空",trigger:"blur",validator:d.b},{type:"string",min:6,message:"密码长度不能小于6",trigger:"blur"}],password:[{required:!0,message:"新密码不能为空",trigger:"blur",validator:d.b},{type:"string",min:6,message:"密码长度不能小于6",trigger:"blur"}],rePassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:function(a,r,s){r!==e.formValidate.password?s(new Error("两次输入的密码不一样")):s()},trigger:"blur"}]}}},computed:{userInfo:function(){return this.$store.getters.userInfoS},isGetlocation:function(){return this.$store.getters.isGetlocation}},mounted:function(){this.UsersImage=this.userInfo.Suppliers_HeadImage,this.formData.shopName=this.userInfo.Suppliers_Name,this.formData.ownerName=this.userInfo.Suppliers_ResponPeople,this.formData.phone=this.userInfo.Suppliers_MobilePhone,this.formData.address=this.userInfo.Suppliers_Addr,this.formData.email=this.userInfo.Suppliers_Email,this.formData.IDCardNo=this.userInfo.IDCardNo,this.formData.BusinessNo=this.userInfo.BusinessNo},created:function(){},methods:l()({},Object(u.d)(["SET_USERINFO"]),Object(u.b)(["LogOut"]),{beforeUpload:function(e){var a=!1;this.allowType.forEach(function(r){a=a||e.type==="image/"+r});var r=e.size/1024/1024<2;return a?r||this.$Message.error("上传图片大小不能超过2MB，请重试"):this.$Message.error("只支持gif,jpg,bmp,jpeg,png格式图片，请重试"),a&&r},submitUpdate:function(){var e=this;return i()(t.a.mark(function a(){var r,s;return t.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(r=JSON.parse(localStorage.getItem("userInfoS"))).Suppliers_HeadImage=e.UsersImage,a.next=4,e.$request.updateUserInfo(r);case 4:a.sent?(s=r,e.SET_USERINFO(s),e.$Message.success("提交成功"),e.$router.go()):e.$Message.error("提交失败");case 6:case"end":return a.stop()}},a,e)}))()},submitInfo:function(){var e,a=this;this.$refs.formInfo.validate((e=i()(t.a.mark(function e(r){var s,o,i,n;return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=18;break}return(s=JSON.parse(localStorage.getItem("userInfoS"))).Code="",s.Msg="",s.Suppliers_HeadImage=a.UsersImage,s.Suppliers_Name=a.formData.shopName,s.Suppliers_ResponPeople=a.formData.ownerName,s.Suppliers_MobilePhone=a.formData.phone,s.Suppliers_Addr=a.formData.address,s.Suppliers_Email=a.formData.email,s.IDCardNo=a.formData.IDCardNo,s.BusinessNo=a.formData.BusinessNo,e.next=14,a.$request.updateUserInfo(s);case 14:(o=e.sent)&&0==o.code?(i=s,a.SET_USERINFO(i),a.$Message.success("修改成功"),n=setTimeout(function(){a.$router.go(),clearTimeout(n)},1e3)):a.$Message.error("修改失败"),e.next=19;break;case 18:a.$Message.error("请填写正确的信息");case 19:case"end":return e.stop()}},e,a)})),function(a){return e.apply(this,arguments)}))},uploadUsersImage:function(e){var a=this;return i()(t.a.mark(function r(){return t.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a.uploadImg(e,"UsersImage");case 2:case"end":return r.stop()}},r,a)}))()},submitPwd:function(){var e,a=this;this.$refs.formPwd.validate((e=i()(t.a.mark(function e(r){var s;return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=8;break}return s=JSON.parse(localStorage.getItem("userInfoS")),e.next=4,a.$request.updatePwd(s.Suppliers_MobilePhone,a.formValidate.oldPassword,a.formValidate.password);case 4:e.sent?(a.$Message.success("修改成功"),a.LogOut(),a.$router.push({path:"/"})):a.$Message.error("修改失败"),e.next=9;break;case 8:a.$Message.error("请填写正确的信息");case 9:case"end":return e.stop()}},e,a)})),function(a){return e.apply(this,arguments)}))},uploadImg:function(e,a){var r=this;return i()(t.a.mark(function s(){var o;return t.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.$request.uploadImg(e.file);case 2:(o=s.sent)?(r.$Message.success("上传成功"),r[""+a]=o.content):r.$Message.error("上传失败");case 4:case"end":return s.stop()}},s,r)}))()}})},p={render:function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("div",[r("div",{staticClass:"add-container"},[e._m(0),e._v(" "),r("div",{staticClass:"imgBox"},[r("p",{staticClass:"title"},[e._v("头像")]),e._v(" "),r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,accept:".jpg,.jpeg,.png,.gif,.bmp,.JPG,.JPEG,.PNG,.GIF,.BMP","http-request":e.uploadUsersImage,"before-upload":e.beforeUpload}},[e.UsersImage?r("img",{staticClass:"avatar",attrs:{src:e.isGetlocation+e.UsersImage}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),r("div",{staticClass:"add-box"},[r("Form",{ref:"formInfo",attrs:{model:e.formData,"label-position":"left","label-width":100,rules:e.ruleInline}},[r("FormItem",{attrs:{label:"供应商名称",prop:"shopName"}},[r("i-input",{attrs:{size:"large"},model:{value:e.formData.shopName,callback:function(a){e.$set(e.formData,"shopName",a)},expression:"formData.shopName"}})],1),e._v(" "),r("FormItem",{attrs:{label:"负责人",prop:"ownerName"}},[r("i-input",{attrs:{size:"large"},model:{value:e.formData.ownerName,callback:function(a){e.$set(e.formData,"ownerName",a)},expression:"formData.ownerName"}})],1),e._v(" "),r("FormItem",{attrs:{label:"联系电话",prop:"phone"}},[r("span",{staticStyle:{"font-size":"15px"}},[e._v(e._s(e.formData.phone))])]),e._v(" "),r("FormItem",{attrs:{label:"供应商地址",prop:"address"}},[r("i-input",{attrs:{size:"large"},model:{value:e.formData.address,callback:function(a){e.$set(e.formData,"address",a)},expression:"formData.address"}})],1),e._v(" "),r("FormItem",{attrs:{label:"邮箱",prop:"email"}},[r("i-input",{attrs:{size:"large"},model:{value:e.formData.email,callback:function(a){e.$set(e.formData,"email",a)},expression:"formData.email"}})],1),e._v(" "),r("FormItem",{attrs:{label:"身份证号码",prop:"IDCardNo"}},[r("i-input",{attrs:{size:"large"},model:{value:e.formData.IDCardNo,callback:function(a){e.$set(e.formData,"IDCardNo",a)},expression:"formData.IDCardNo"}})],1),e._v(" "),r("FormItem",{attrs:{label:"营业执照号",prop:"BusinessNo"}},[r("i-input",{attrs:{size:"large"},model:{value:e.formData.BusinessNo,callback:function(a){e.$set(e.formData,"BusinessNo",a)},expression:"formData.BusinessNo"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"add-submit"},[r("Button",{attrs:{type:"primary"},on:{click:e.submitInfo}},[e._v("确认修改")])],1)]),e._v(" "),r("div",{staticClass:"add-container"},[e._m(1),e._v(" "),r("div",{staticClass:"add-box"},[r("Form",{ref:"formPwd",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-position":"left","label-width":100}},[r("FormItem",{attrs:{label:"旧密码",prop:"oldPassword"}},[r("i-input",{attrs:{type:"password",clearable:"",size:"large",placeholder:"请输入旧密码"},model:{value:e.formValidate.oldPassword,callback:function(a){e.$set(e.formValidate,"oldPassword",a)},expression:"formValidate.oldPassword"}})],1),e._v(" "),r("FormItem",{attrs:{label:"新密码",prop:"password"}},[r("i-input",{attrs:{type:"password",clearable:"",size:"large",placeholder:"请输入新密码"},model:{value:e.formValidate.password,callback:function(a){e.$set(e.formValidate,"password",a)},expression:"formValidate.password"}})],1),e._v(" "),r("FormItem",{attrs:{label:"确认新密码",prop:"rePassword"}},[r("i-input",{attrs:{type:"password",clearable:"",size:"large",placeholder:"请再次输入新密码"},model:{value:e.formValidate.rePassword,callback:function(a){e.$set(e.formValidate,"rePassword",a)},expression:"formValidate.rePassword"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"add-submit"},[r("Button",{attrs:{type:"primary"},on:{click:e.submitPwd}},[e._v("确认修改")])],1)])])},staticRenderFns:[function(){var e=this.$createElement,a=this._self._c||e;return a("div",{staticClass:"add-title"},[a("h1",[this._v("供货商信息")])])},function(){var e=this.$createElement,a=this._self._c||e;return a("div",{staticClass:"add-title"},[a("h1",[this._v("修改密码")])])}]};var c=r("VU/8")(m,p,!1,function(e){r("R/vo")},"data-v-565bae55",null);a.default=c.exports},"R/vo":function(e,a){}});
//# sourceMappingURL=15.5e272962bbc23b89daaa1560476466300.js.map